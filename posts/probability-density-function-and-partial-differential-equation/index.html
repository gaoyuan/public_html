<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Probability Density Function and Partial Differential Equation -- gaoyuan</title>
        
        <link rel="stylesheet" href="../../fonts/Serif/cmun-serif.css" />
        <link rel="stylesheet" href="../../fonts/Serif-Slanted/cmun-serif-slanted.css" />

        <!--BOOTSTRAP-->
        <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <!--mobile first-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!--removed html from url but still is html-->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

        <!--font awesome-->
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

        <!--fonts: allan & cardo-->
        <link href="http://fonts.googleapis.com/css?family=Droid+Serif" rel="stylesheet" type="text/css">

        <link href="../../css/default.css" rel="stylesheet">

        <link href="../../comments/inlineDisqussions.css" rel="stylesheet">

        <!--Highlight-->
        <link href="../../highlight/styles/github.css" rel="stylesheet">
        
        <!--Favicon-->
        <link rel="apple-touch-icon" sizes="57x57" href="../../favicon/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="../../favicon/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="../../favicon/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="../../favicon/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="../../favicon/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="../../favicon/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="../../favicon/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="../../favicon/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="../../favicon/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" href="../../favicon/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="../../favicon/android-chrome-192x192.png" sizes="192x192">
        <link rel="icon" type="image/png" href="../../favicon/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="../../favicon/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="../../favicon/manifest.json">
        <link rel="mask-icon" href="../../favicon/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="shortcut icon" href="../../favicon/favicon.ico">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="msapplication-TileImage" content="/favicon/mstile-144x144.png">
        <meta name="msapplication-config" content="/favicon/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

         <!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
mixpanel.init("9bdb560cbfa2056a137fef3132c46888");
mixpanel.track("Page View");</script><!-- end Mixpanel -->

    </head>

    <body>
        <div id="wrap">
            
            <div id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8">

                            <h1><a href="../../">高远</a><div id="contact"><a href="http://www.linkedin.com/in/gaoyuanuw" title="LinkedIn"><i class="fa fa-linkedin-square"></i></a> <a href="http://github.com/gaoyuan" title="Github"><i class="fa fa-github-square"></i></a></div></h1>
                            
                            <div class="article">
                                <h1>Probability Density Function and Partial Differential Equation</h1>
                                <div class="info">
    <p style="font-family:CMSS; font-size:120%">Posted on May 27, 2014</p>
    probability, stochastic process, brownian motion, differential equation, partial differential equation
    <!--
        by gaoyuan
    -->
</div>
</br>

<p>Consider the following problem:</p>
<blockquote>
<p>The price of a stock is described by a Brownian motion. Suppose the starting price is 5, and the company defaults if ever the price drops to zero. What is the probability that the company is bankrupt at time <span class="math inline">\(T\)</span>? What is the probability that the price is above 10 at time <span class="math inline">\(T\)</span>?</p>
</blockquote>
Let’s say the price of the stock is described by the time series <span class="math inline">\(p(t)\)</span>. The company is bankrupt at time <span class="math inline">\(T\)</span> if <span class="math inline">\(\exists s \le T\)</span>, such that <span class="math inline">\(p(s) = 0\)</span>. By the reflection principle of Brownian motion,
\begin{equation}
P\left(inf_{0\le s\le T}p(s) \le 0\right) = 2P\left(p(T) \le 0\right) = 2\int_{-\infty}^{-5}\frac{1}{\sqrt{2\pi T}}e^{\frac{-x^2}{2T}}dx.
\end{equation}
For the second question, we need <span class="math inline">\(p(T) &gt; 10\)</span> and <span class="math inline">\(p(s) &gt; 0, \forall 0 \le s \le T\)</span>. The probability can be calculated as
\begin{equation}
P\left(p(T) &gt; 10\right) - P\left(p(T) &gt; 10 \cap inf_{0\le s\le T}p(s) \le 0\right),
\end{equation}
using the fact that <span class="math inline">\(P(A\cap B) = P(A) - P(A\cap B^\complement)\)</span>. Note that the latter part is equal to <span class="math inline">\(P\left(p(T) &lt; -10\right)\)</span> (Imagine the price first hits zero, then the probability that it goes back above 10 is equal to a reflecting process that drops below -10). Therefore the probability that the price is above 10 at time <span class="math inline">\(T\)</span> is
\begin{equation}
P\left(p(T) &lt; 0\right) - P\left(p(T) &lt; -10\right) = P\left(-10 \le p(T) &lt; 0\right) = \int_{-15}^{-5}\frac{1}{\sqrt{2\pi T}}e^{\frac{-x^2}{2T}}dx.
\end{equation}
Now let’s solve the problem in another way. We know that Brownian motion is governed by the following partial differential equation
\begin{equation}
p_t(x, t) = Dp_{xx}(x, t),
\end{equation}
<p>where <span class="math inline">\(p(x,t)\)</span> is the probability density. For a standard Brownian motion, we have <span class="math inline">\(D = 1/2\)</span>. Going back to our problem, we know the stock price satisfies this PDE, with boundary conditions <span class="math inline">\(p(0, t) = 0\)</span> and <span class="math inline">\(p(x, t) \rightarrow 0, x \rightarrow \infty\)</span>. The absorbing boundary condition reflects the fact that once the price drops to zero, we are at the point of no return. The initial condition for the density is given by <span class="math inline">\(p(x, 0) = \delta(x - 5)\)</span>.</p>
To solve for this PDE with the above initial and boundary conditions, one common trick is to apply the Green function and the method of images. That is, we imagine another point source that is outside of the domain (at <span class="math inline">\(x = -5\)</span>) which counteracts the point source at <span class="math inline">\(x = 5\)</span> to give us the boundary condition. The solution is therefore the superposition of two Green functions
\begin{equation}
p(x, t) = G(5) - G(-5) = \frac{1}{\sqrt{2\pi t}}\left(e^{\frac{-(x-5)^2}{2t}} - e^{\frac{-(x+5)^2}{2t}} \right).
\end{equation}
<p>See a plot of this density:</p>
<div class="bigcenterimgcontainer">
<p><img src="img/fig.png" alt style></p>
</div>
The probability that the company is bankrupt at <span class="math inline">\(T\)</span> is given by
\begin{equation}
1 - \int_0^\infty p(x, T).
\end{equation}
The probability that the price is above 10 at <span class="math inline">\(T\)</span> is given by
\begin{equation}
\int_{10}^\infty p(x, T).
\end{equation}
<p>We can see the close relationship between the method of images and the reflection principle of Brownian motion.</p>

<div id="disqus_thread"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

<script src="../../comments/inlineDisqussions.js"></script>
<script src="../../js/disqus.js"></script>

                            </div>
                            
                        </div>
                        <div class="col-md-4"></div>
                    </div>
               </div>
               
           </div>
        
    <!-- jQuery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script src="../../bootstrap/js/bootstrap.min.js"></script>

    <script src="../../highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script src="../../js/footnotes.js"></script>

    <script src="../../comments/inlineDisqussions.js"></script>
    
    <noscript>Enable JavaScript for footnotes, Disqus comments, and other cool stuff.</noscript>

    </body>

</html>
